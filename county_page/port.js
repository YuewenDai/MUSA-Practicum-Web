//var parse_georaster = require("georaster");

//var GeoRasterLayer = require("georaster-layer-for-leaflet");

var map = L.map('map', {
    center: [36.848253, -76.364559],
    zoom: 13
  });


var Stamen_Terrain = L.tileLayer('http://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}.png', {
    attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    subdomains: 'abcd',
    minZoom: 8,
    maxZoom: 18,
    ext: 'png'
  }).addTo(map);

  
//GeoJson Part

const portdata = {
  "type": "FeatureCollection",
  "name": "port_tracts18",
  "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
  "features": [
  { "type": "Feature", "properties": { "GEOID": "517402130021", "TotalPop": 754.0, "MedHHInc": 102614.0, "TotalUnit": 296.0, "pctWhite": 100.0, "area": 1550543.2875160344 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.381322, 36.840379 ], [ -76.380545, 36.846353 ], [ -76.37975, 36.848026 ], [ -76.37914, 36.851833 ], [ -76.374484, 36.848513 ], [ -76.370141, 36.8459 ], [ -76.362317, 36.84284 ], [ -76.364365, 36.838948 ], [ -76.366065, 36.838248 ], [ -76.374494, 36.838415 ], [ -76.376566, 36.838448 ], [ -76.383466, 36.837548 ], [ -76.381322, 36.840379 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131042", "TotalPop": 1497.0, "MedHHInc": 99688.0, "TotalUnit": 480.0, "pctWhite": 41.883767535070135, "area": 1560912.9841830882 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.406907989639592, 36.897507189467497 ], [ -76.403791, 36.897836 ], [ -76.395392719935302, 36.896775115943399 ], [ -76.394513, 36.891718 ], [ -76.391164, 36.890241 ], [ -76.390514, 36.888017 ], [ -76.390519, 36.884947 ], [ -76.39068, 36.881675 ], [ -76.39111, 36.881103 ], [ -76.396609, 36.877849 ], [ -76.396589, 36.879215 ], [ -76.397922, 36.880877 ], [ -76.397998, 36.883912 ], [ -76.399937, 36.889383 ], [ -76.404556, 36.891491 ], [ -76.404392, 36.894523 ], [ -76.406907989639592, 36.897507189467497 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402126003", "TotalPop": 726.0, "MedHHInc": 63319.0, "TotalUnit": 399.0, "pctWhite": 55.647382920110189, "area": 379426.95906058874 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.335661, 36.808736 ], [ -76.33402, 36.808833 ], [ -76.334409, 36.811682 ], [ -76.331979, 36.812313 ], [ -76.328818, 36.813671 ], [ -76.327603, 36.811269 ], [ -76.328952, 36.809362 ], [ -76.329086, 36.806586 ], [ -76.335477, 36.806277 ], [ -76.335661, 36.808736 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127012", "TotalPop": 935.0, "MedHHInc": 56477.0, "TotalUnit": 366.0, "pctWhite": 0.0, "area": 566148.03387147526 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.362901, 36.802377 ], [ -76.361996, 36.804116 ], [ -76.358122, 36.806788 ], [ -76.356246, 36.80748 ], [ -76.354013, 36.804428 ], [ -76.351904, 36.800748 ], [ -76.356863, 36.799662 ], [ -76.363147, 36.799784 ], [ -76.362901, 36.802377 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402103003", "TotalPop": 820.0, "MedHHInc": 50903.0, "TotalUnit": 409.0, "pctWhite": 84.268292682926827, "area": 762316.45098899421 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.35213, 36.853115 ], [ -76.350096, 36.854382 ], [ -76.344272, 36.848555 ], [ -76.345429, 36.847428 ], [ -76.345815, 36.845772 ], [ -76.344697, 36.84247 ], [ -76.347381, 36.842311 ], [ -76.349222, 36.8411 ], [ -76.350265, 36.844748 ], [ -76.350465, 36.845648 ], [ -76.356265, 36.849148 ], [ -76.35213, 36.853115 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131013", "TotalPop": 2086.0, "MedHHInc": 55139.0, "TotalUnit": 865.0, "pctWhite": 29.242569511025884, "area": 900245.94349006936 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.419353, 36.867539 ], [ -76.413434, 36.874257 ], [ -76.411067, 36.876148 ], [ -76.400303, 36.873875 ], [ -76.401431, 36.87216 ], [ -76.401168, 36.869902 ], [ -76.418538, 36.867721 ], [ -76.419353, 36.867539 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131012", "TotalPop": 1336.0, "MedHHInc": 29157.0, "TotalUnit": 675.0, "pctWhite": 22.82934131736527, "area": 440197.01288813143 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.419353, 36.867539 ], [ -76.418538, 36.867721 ], [ -76.401168, 36.869902 ], [ -76.39999, 36.866305 ], [ -76.401467, 36.866548 ], [ -76.420368, 36.866348 ], [ -76.419353, 36.867539 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402121001", "TotalPop": 402.0, "MedHHInc": 18452.0, "TotalUnit": 185.0, "pctWhite": 0.0, "area": 860870.18762675172 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.306588, 36.830172 ], [ -76.304718, 36.83086 ], [ -76.300351, 36.831154 ], [ -76.294543, 36.8324 ], [ -76.293135, 36.829219 ], [ -76.297971, 36.826596 ], [ -76.295485, 36.82209 ], [ -76.299478, 36.820537 ], [ -76.301203, 36.820955 ], [ -76.299489, 36.823371 ], [ -76.300327, 36.824915 ], [ -76.306322, 36.824646 ], [ -76.306588, 36.830172 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402109001", "TotalPop": 1307.0, "MedHHInc": 42386.0, "TotalUnit": 858.0, "pctWhite": 46.748278500382554, "area": 708631.95991228695 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.308467, 36.836715 ], [ -76.295045, 36.837046 ], [ -76.294962, 36.833348 ], [ -76.294543, 36.8324 ], [ -76.300351, 36.831154 ], [ -76.304718, 36.83086 ], [ -76.306588, 36.830172 ], [ -76.306771, 36.83364 ], [ -76.30833, 36.833605 ], [ -76.308402, 36.835144 ], [ -76.308467, 36.836715 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402105001", "TotalPop": 2138.0, "MedHHInc": 19657.0, "TotalUnit": 790.0, "pctWhite": 1.824134705332086, "area": 1012834.0268701366 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.346805, 36.835327 ], [ -76.338593, 36.840989 ], [ -76.330947, 36.845921 ], [ -76.330831, 36.845385 ], [ -76.330346, 36.837639 ], [ -76.330414, 36.834647 ], [ -76.338813, 36.834439 ], [ -76.33942, 36.834436 ], [ -76.345088, 36.83447 ], [ -76.346805, 36.835327 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402126001", "TotalPop": 29.0, "MedHHInc": 19657.0, "TotalUnit": 19.0, "pctWhite": 44.827586206896555, "area": 1503334.6463367573 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.35936, 36.812327 ], [ -76.35526, 36.814372 ], [ -76.352379, 36.81582 ], [ -76.346662, 36.815333 ], [ -76.34413, 36.815431 ], [ -76.345903, 36.814093 ], [ -76.345377, 36.810821 ], [ -76.34284, 36.808396 ], [ -76.342635, 36.805872 ], [ -76.34446, 36.805411 ], [ -76.348689, 36.802407 ], [ -76.351904, 36.800748 ], [ -76.354013, 36.804428 ], [ -76.356246, 36.80748 ], [ -76.359105, 36.811344 ], [ -76.35936, 36.812327 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402129003", "TotalPop": 1396.0, "MedHHInc": 60403.0, "TotalUnit": 459.0, "pctWhite": 88.53868194842407, "area": 694978.04872690805 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.377016, 36.827498 ], [ -76.373084, 36.826054 ], [ -76.370386, 36.826169 ], [ -76.368736, 36.825157 ], [ -76.368254, 36.824887 ], [ -76.372273, 36.818177 ], [ -76.373209, 36.818345 ], [ -76.380509, 36.819625 ], [ -76.377016, 36.827498 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402114002", "TotalPop": 982.0, "MedHHInc": 21896.0, "TotalUnit": 358.0, "pctWhite": 2.6476578411405294, "area": 399895.1311884938 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.339103, 36.829547 ], [ -76.338125, 36.829346 ], [ -76.337104, 36.830324 ], [ -76.334623, 36.82772 ], [ -76.330034, 36.830482 ], [ -76.329769, 36.827031 ], [ -76.337674, 36.823104 ], [ -76.338868, 36.82444 ], [ -76.339005, 36.826168 ], [ -76.339515, 36.829135 ], [ -76.339103, 36.829547 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402117001", "TotalPop": 962.0, "MedHHInc": 43333.0, "TotalUnit": 452.0, "pctWhite": 2.7027027027027026, "area": 713675.93830349529 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.329769, 36.827031 ], [ -76.329539, 36.824082 ], [ -76.328757, 36.821013 ], [ -76.326358, 36.81798 ], [ -76.325215, 36.817145 ], [ -76.328802, 36.816379 ], [ -76.336398, 36.815872 ], [ -76.336641, 36.820983 ], [ -76.332266, 36.821042 ], [ -76.329522, 36.82069 ], [ -76.337674, 36.823104 ], [ -76.329769, 36.827031 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402118003", "TotalPop": 1258.0, "MedHHInc": 31848.0, "TotalUnit": 457.0, "pctWhite": 0.79491255961844187, "area": 310118.46478240937 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.319651, 36.825431 ], [ -76.318019, 36.825661 ], [ -76.312471, 36.825909 ], [ -76.312403, 36.824471 ], [ -76.312263, 36.821488 ], [ -76.31946, 36.821275 ], [ -76.319651, 36.825431 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402121002", "TotalPop": 1144.0, "MedHHInc": 30682.0, "TotalUnit": 456.0, "pctWhite": 2.1853146853146854, "area": 326588.8795253557 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.306322, 36.824646 ], [ -76.300327, 36.824915 ], [ -76.299489, 36.823371 ], [ -76.301203, 36.820955 ], [ -76.299478, 36.820537 ], [ -76.3033, 36.819093 ], [ -76.306046, 36.818693 ], [ -76.306322, 36.824646 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402126002", "TotalPop": 264.0, "MedHHInc": 65096.0, "TotalUnit": 112.0, "pctWhite": 81.818181818181827, "area": 420112.35049250175 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.345377, 36.810821 ], [ -76.337214, 36.810987 ], [ -76.334409, 36.811682 ], [ -76.33402, 36.808833 ], [ -76.335661, 36.808736 ], [ -76.335477, 36.806277 ], [ -76.342635, 36.805872 ], [ -76.34284, 36.808396 ], [ -76.345377, 36.810821 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402103001", "TotalPop": 708.0, "MedHHInc": 82875.0, "TotalUnit": 295.0, "pctWhite": 40.536723163841806, "area": 724183.2591527534 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.34576, 36.85607 ], [ -76.342397, 36.854398 ], [ -76.342119, 36.849857 ], [ -76.340392, 36.84806 ], [ -76.339146, 36.848125 ], [ -76.338731, 36.842773 ], [ -76.344697, 36.84247 ], [ -76.345815, 36.845772 ], [ -76.345429, 36.847428 ], [ -76.344272, 36.848555 ], [ -76.350096, 36.854382 ], [ -76.34576, 36.85607 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402106002", "TotalPop": 634.0, "MedHHInc": 38813.0, "TotalUnit": 325.0, "pctWhite": 54.416403785488953, "area": 403192.20057376346 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.325648, 36.842948 ], [ -76.321714, 36.842039 ], [ -76.318075, 36.841932 ], [ -76.318458, 36.837124 ], [ -76.325389, 36.837439 ], [ -76.327126, 36.837796 ], [ -76.325648, 36.842948 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127021", "TotalPop": 2009.0, "MedHHInc": 49068.0, "TotalUnit": 716.0, "pctWhite": 3.2354405176704826, "area": 846959.03763238736 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.363147, 36.799784 ], [ -76.356863, 36.799662 ], [ -76.351904, 36.800748 ], [ -76.349962, 36.798408 ], [ -76.349874, 36.797102 ], [ -76.351295, 36.796942 ], [ -76.351445, 36.794567 ], [ -76.353162, 36.793376 ], [ -76.357786, 36.792755 ], [ -76.363595, 36.79291 ], [ -76.363147, 36.799784 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131011", "TotalPop": 1355.0, "MedHHInc": 41467.0, "TotalUnit": 612.0, "pctWhite": 8.2656826568265682, "area": 1086687.8795918361 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.401431, 36.87216 ], [ -76.400303, 36.873875 ], [ -76.400152, 36.873843 ], [ -76.39498, 36.872812 ], [ -76.393835, 36.872412 ], [ -76.393267, 36.872066 ], [ -76.392063, 36.870329 ], [ -76.392815, 36.864472 ], [ -76.393012, 36.863546 ], [ -76.393259, 36.862149 ], [ -76.393859, 36.85797 ], [ -76.394267, 36.856848 ], [ -76.396218, 36.856947 ], [ -76.399366, 36.857244 ], [ -76.398976, 36.861012 ], [ -76.398475, 36.865079 ], [ -76.39999, 36.866305 ], [ -76.401168, 36.869902 ], [ -76.401431, 36.87216 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402120001", "TotalPop": 748.0, "MedHHInc": 30808.0, "TotalUnit": 307.0, "pctWhite": 2.9411764705882351, "area": 309792.10513793991 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.312672, 36.830043 ], [ -76.309156, 36.829306 ], [ -76.306588, 36.830172 ], [ -76.306322, 36.824646 ], [ -76.312403, 36.824471 ], [ -76.312471, 36.825909 ], [ -76.312635, 36.829462 ], [ -76.312672, 36.830043 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402124003", "TotalPop": 1181.0, "MedHHInc": 20788.0, "TotalUnit": 589.0, "pctWhite": 0.93141405588484327, "area": 238262.23197397613 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.335266, 36.794763 ], [ -76.335164, 36.796139 ], [ -76.333821, 36.796133 ], [ -76.327277, 36.795067 ], [ -76.328806, 36.792999 ], [ -76.336043, 36.791923 ], [ -76.335266, 36.794763 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402124001", "TotalPop": 1403.0, "MedHHInc": 46136.0, "TotalUnit": 517.0, "pctWhite": 43.406985032074125, "area": 922916.18619828415 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.329086, 36.806586 ], [ -76.328952, 36.809362 ], [ -76.327603, 36.811269 ], [ -76.328818, 36.813671 ], [ -76.323085, 36.815415 ], [ -76.322822, 36.815922 ], [ -76.314444, 36.812539 ], [ -76.316478, 36.810671 ], [ -76.319869, 36.806598 ], [ -76.329082, 36.806516 ], [ -76.329086, 36.806586 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127013", "TotalPop": 2447.0, "MedHHInc": 55859.0, "TotalUnit": 898.0, "pctWhite": 8.1324070290151198, "area": 1328790.3428857545 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.376457, 36.789401 ], [ -76.372994, 36.789513 ], [ -76.373354, 36.792751 ], [ -76.371648, 36.795433 ], [ -76.372123, 36.797294 ], [ -76.374319, 36.799216 ], [ -76.372202, 36.80039 ], [ -76.370441, 36.800503 ], [ -76.363147, 36.799784 ], [ -76.363595, 36.79291 ], [ -76.363882, 36.787798 ], [ -76.375679, 36.786062 ], [ -76.377638, 36.788073 ], [ -76.376457, 36.789401 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127022", "TotalPop": 1564.0, "MedHHInc": 40625.0, "TotalUnit": 708.0, "pctWhite": 3.3248081841432229, "area": 929763.21163292101 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.363882, 36.787798 ], [ -76.363595, 36.79291 ], [ -76.357786, 36.792755 ], [ -76.353162, 36.793376 ], [ -76.351445, 36.794567 ], [ -76.351295, 36.796942 ], [ -76.349874, 36.797102 ], [ -76.349122, 36.796367 ], [ -76.344996, 36.793695 ], [ -76.342065, 36.791032 ], [ -76.363839, 36.787804 ], [ -76.363882, 36.787798 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131035", "TotalPop": 1119.0, "MedHHInc": 72308.0, "TotalUnit": 488.0, "pctWhite": 47.989276139410187, "area": 752613.13540863944 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.394711, 36.896689 ], [ -76.391046941047705, 36.895827615193099 ], [ -76.39067, 36.895739 ], [ -76.390491932733298, 36.8958457504649 ], [ -76.388467, 36.896735 ], [ -76.387497, 36.894673 ], [ -76.38044, 36.893464 ], [ -76.380702, 36.890216 ], [ -76.390143, 36.888781 ], [ -76.390514, 36.888017 ], [ -76.391164, 36.890241 ], [ -76.394513, 36.891718 ], [ -76.395392719935302, 36.896775115943399 ], [ -76.394711, 36.896689 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402128011", "TotalPop": 1105.0, "MedHHInc": 42455.0, "TotalUnit": 558.0, "pctWhite": 71.221719457013577, "area": 772786.81935532484 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.382786, 36.807987 ], [ -76.381526, 36.814362 ], [ -76.380509, 36.819625 ], [ -76.373209, 36.818345 ], [ -76.374192, 36.814956 ], [ -76.375236, 36.810005 ], [ -76.379649, 36.809631 ], [ -76.380824, 36.807987 ], [ -76.378388, 36.806215 ], [ -76.381705, 36.805222 ], [ -76.382786, 36.807987 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402111001", "TotalPop": 729.0, "MedHHInc": 36528.0, "TotalUnit": 339.0, "pctWhite": 1.7832647462277091, "area": 374494.67884357931 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.317956, 36.832902 ], [ -76.316759, 36.833401 ], [ -76.30833, 36.833605 ], [ -76.306771, 36.83364 ], [ -76.306588, 36.830172 ], [ -76.309156, 36.829306 ], [ -76.312672, 36.830043 ], [ -76.315481, 36.830654 ], [ -76.317496, 36.831184 ], [ -76.318245, 36.831801 ], [ -76.317956, 36.832902 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402115001", "TotalPop": 784.0, "MedHHInc": 53333.0, "TotalUnit": 283.0, "pctWhite": 49.362244897959187, "area": 695065.70856743201 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.347536, 36.834242 ], [ -76.347205, 36.835576 ], [ -76.346805, 36.835327 ], [ -76.345088, 36.83447 ], [ -76.33942, 36.834436 ], [ -76.338813, 36.834439 ], [ -76.339247, 36.83348 ], [ -76.339103, 36.829547 ], [ -76.339515, 36.829135 ], [ -76.339005, 36.826168 ], [ -76.34728, 36.825984 ], [ -76.347389, 36.828967 ], [ -76.347536, 36.834242 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402128021", "TotalPop": 1518.0, "MedHHInc": 56220.0, "TotalUnit": 602.0, "pctWhite": 75.757575757575751, "area": 1229708.3860853834 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.39769, 36.82022 ], [ -76.396337, 36.821034 ], [ -76.396055, 36.822543 ], [ -76.395123, 36.822226 ], [ -76.380509, 36.819625 ], [ -76.381526, 36.814362 ], [ -76.382786, 36.807987 ], [ -76.381705, 36.805222 ], [ -76.379855, 36.803931 ], [ -76.378543, 36.80277 ], [ -76.381243, 36.80142 ], [ -76.384489, 36.804413 ], [ -76.386264, 36.808274 ], [ -76.386659, 36.811151 ], [ -76.386429, 36.81318 ], [ -76.390528, 36.816468 ], [ -76.393181, 36.819253 ], [ -76.393708, 36.820277 ], [ -76.39736, 36.81948 ], [ -76.39769, 36.82022 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402120002", "TotalPop": 1079.0, "MedHHInc": 36550.0, "TotalUnit": 515.0, "pctWhite": 1.7608897126969416, "area": 518295.40590240416 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.312403, 36.824471 ], [ -76.306322, 36.824646 ], [ -76.306046, 36.818693 ], [ -76.306359, 36.817151 ], [ -76.311899, 36.81439 ], [ -76.312086, 36.81931 ], [ -76.312263, 36.821488 ], [ -76.312403, 36.824471 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402128012", "TotalPop": 1608.0, "MedHHInc": 35347.0, "TotalUnit": 595.0, "pctWhite": 35.758706467661696, "area": 515737.53978526144 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.373209, 36.818345 ], [ -76.372273, 36.818177 ], [ -76.361965, 36.816091 ], [ -76.359854, 36.815805 ], [ -76.359454, 36.812834 ], [ -76.361997, 36.811667 ], [ -76.370222, 36.814522 ], [ -76.374192, 36.814956 ], [ -76.373209, 36.818345 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127014", "TotalPop": 622.0, "MedHHInc": 68125.0, "TotalUnit": 231.0, "pctWhite": 1.929260450160772, "area": 806595.17430108471 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.380615, 36.797542 ], [ -76.378342, 36.797311 ], [ -76.374319, 36.799216 ], [ -76.372123, 36.797294 ], [ -76.371648, 36.795433 ], [ -76.373354, 36.792751 ], [ -76.372994, 36.789513 ], [ -76.376457, 36.789401 ], [ -76.377638, 36.788073 ], [ -76.384628, 36.795695 ], [ -76.380615, 36.797542 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402102001", "TotalPop": 821.0, "MedHHInc": 79063.0, "TotalUnit": 357.0, "pctWhite": 74.543239951278935, "area": 1220358.1161481107 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.34576, 36.85607 ], [ -76.340564, 36.857848 ], [ -76.33296, 36.866055 ], [ -76.331584, 36.850299 ], [ -76.339295, 36.849902 ], [ -76.339146, 36.848125 ], [ -76.340392, 36.84806 ], [ -76.342119, 36.849857 ], [ -76.342397, 36.854398 ], [ -76.34576, 36.85607 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402118002", "TotalPop": 863.0, "MedHHInc": 39750.0, "TotalUnit": 382.0, "pctWhite": 12.050984936268829, "area": 589924.50792515976 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.329539, 36.824082 ], [ -76.324963, 36.827033 ], [ -76.316149, 36.829265 ], [ -76.312635, 36.829462 ], [ -76.312471, 36.825909 ], [ -76.318019, 36.825661 ], [ -76.319651, 36.825431 ], [ -76.31946, 36.821275 ], [ -76.324043, 36.821135 ], [ -76.324196, 36.824607 ], [ -76.326183, 36.825211 ], [ -76.329539, 36.824082 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131032", "TotalPop": 715.0, "MedHHInc": 106328.0, "TotalUnit": 235.0, "pctWhite": 57.762237762237767, "area": 611231.61321066751 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.393835, 36.872412 ], [ -76.39109, 36.873587 ], [ -76.389672, 36.873242 ], [ -76.386993, 36.876419 ], [ -76.382112, 36.879447 ], [ -76.380858, 36.878868 ], [ -76.377846, 36.878628 ], [ -76.377943, 36.878159 ], [ -76.377949, 36.874851 ], [ -76.377997, 36.872553 ], [ -76.388734, 36.87263 ], [ -76.393267, 36.872066 ], [ -76.393835, 36.872412 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402130011", "TotalPop": 434.0, "MedHHInc": 106328.0, "TotalUnit": 0.0, "pctWhite": 62.903225806451616, "area": 15857461.907826519 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.390491932733298, 36.8958457504649 ], [ -76.388293, 36.897164 ], [ -76.387567, 36.899547 ], [ -76.385867, 36.923247 ], [ -76.384134, 36.924435 ], [ -76.356444, 36.924055 ], [ -76.354533, 36.922759 ], [ -76.349433, 36.895168 ], [ -76.345749, 36.894218 ], [ -76.341233, 36.894028 ], [ -76.339569, 36.893078 ], [ -76.330406969951596, 36.8893162532299 ], [ -76.331008, 36.888099 ], [ -76.333598, 36.882216 ], [ -76.340467, 36.881073 ], [ -76.347621, 36.883043 ], [ -76.35008, 36.880816 ], [ -76.367961, 36.880083 ], [ -76.366185, 36.882022 ], [ -76.366195, 36.884219 ], [ -76.366542, 36.883816 ], [ -76.367437, 36.883757 ], [ -76.374135, 36.883833 ], [ -76.374871, 36.88103 ], [ -76.374979, 36.881073 ], [ -76.374507, 36.884949 ], [ -76.378454, 36.887153 ], [ -76.380702, 36.890216 ], [ -76.38044, 36.893464 ], [ -76.387497, 36.894673 ], [ -76.388467, 36.896735 ], [ -76.390491932733298, 36.8958457504649 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402117002", "TotalPop": 1313.0, "MedHHInc": 33196.0, "TotalUnit": 570.0, "pctWhite": 19.649657273419649, "area": 834576.2820043558 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.345903, 36.814093 ], [ -76.34413, 36.815431 ], [ -76.343544, 36.815495 ], [ -76.336398, 36.815872 ], [ -76.328802, 36.816379 ], [ -76.325215, 36.817145 ], [ -76.324209, 36.816544 ], [ -76.322822, 36.815922 ], [ -76.323085, 36.815415 ], [ -76.328818, 36.813671 ], [ -76.331979, 36.812313 ], [ -76.334409, 36.811682 ], [ -76.337214, 36.810987 ], [ -76.345377, 36.810821 ], [ -76.345903, 36.814093 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402123004", "TotalPop": 818.0, "MedHHInc": 38750.0, "TotalUnit": 434.0, "pctWhite": 49.511002444987774, "area": 308095.80461076379 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.321538, 36.804457 ], [ -76.318281, 36.804688 ], [ -76.313706, 36.802904 ], [ -76.314358, 36.802287 ], [ -76.316324, 36.799109 ], [ -76.323156, 36.801812 ], [ -76.321538, 36.804457 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402102002", "TotalPop": 1759.0, "MedHHInc": 65000.0, "TotalUnit": 736.0, "pctWhite": 72.370665150653778, "area": 3886742.4203329063 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.339295, 36.849902 ], [ -76.331584, 36.850299 ], [ -76.33296, 36.866055 ], [ -76.330784, 36.868403 ], [ -76.317211, 36.860657 ], [ -76.313533, 36.858533 ], [ -76.306663, 36.854047 ], [ -76.312685, 36.850762 ], [ -76.315498, 36.847498 ], [ -76.319061, 36.847423 ], [ -76.326845, 36.8462 ], [ -76.329521, 36.846749 ], [ -76.330831, 36.845385 ], [ -76.330947, 36.845921 ], [ -76.338593, 36.840989 ], [ -76.338731, 36.842773 ], [ -76.339146, 36.848125 ], [ -76.339295, 36.849902 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402130013", "TotalPop": 2990.0, "MedHHInc": 86078.0, "TotalUnit": 1200.0, "pctWhite": 56.220735785953181, "area": 9500573.8825291637 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.377949, 36.874851 ], [ -76.377943, 36.878159 ], [ -76.377846, 36.878628 ], [ -76.377181, 36.879563 ], [ -76.374979, 36.881073 ], [ -76.374871, 36.88103 ], [ -76.374135, 36.883833 ], [ -76.367437, 36.883757 ], [ -76.366542, 36.883816 ], [ -76.366195, 36.884219 ], [ -76.366185, 36.882022 ], [ -76.367961, 36.880083 ], [ -76.35008, 36.880816 ], [ -76.347621, 36.883043 ], [ -76.340467, 36.881073 ], [ -76.333598, 36.882216 ], [ -76.336784, 36.875027 ], [ -76.330784, 36.868403 ], [ -76.33296, 36.866055 ], [ -76.340564, 36.857848 ], [ -76.34576, 36.85607 ], [ -76.350096, 36.854382 ], [ -76.35213, 36.853115 ], [ -76.355138, 36.854031 ], [ -76.356634, 36.855122 ], [ -76.358862, 36.855689 ], [ -76.361581, 36.857495 ], [ -76.363785, 36.858388 ], [ -76.365553, 36.861645 ], [ -76.368078, 36.865314 ], [ -76.368322, 36.866439 ], [ -76.372568, 36.867423 ], [ -76.377358, 36.865995 ], [ -76.37785, 36.869848 ], [ -76.377938, 36.870461 ], [ -76.377997, 36.872553 ], [ -76.377949, 36.874851 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402127011", "TotalPop": 1537.0, "MedHHInc": 38682.0, "TotalUnit": 344.0, "pctWhite": 6.0507482108002604, "area": 1726614.6689546562 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.386998, 36.798547 ], [ -76.381243, 36.80142 ], [ -76.378543, 36.80277 ], [ -76.35936, 36.812327 ], [ -76.359105, 36.811344 ], [ -76.356246, 36.80748 ], [ -76.358122, 36.806788 ], [ -76.361996, 36.804116 ], [ -76.362901, 36.802377 ], [ -76.363147, 36.799784 ], [ -76.370441, 36.800503 ], [ -76.372202, 36.80039 ], [ -76.374319, 36.799216 ], [ -76.378342, 36.797311 ], [ -76.380615, 36.797542 ], [ -76.384628, 36.795695 ], [ -76.386998, 36.798547 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402114001", "TotalPop": 1227.0, "MedHHInc": 29500.0, "TotalUnit": 499.0, "pctWhite": 6.8459657701711487, "area": 473974.7168794226 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.339247, 36.83348 ], [ -76.338813, 36.834439 ], [ -76.330414, 36.834647 ], [ -76.330034, 36.830482 ], [ -76.334623, 36.82772 ], [ -76.337104, 36.830324 ], [ -76.338125, 36.829346 ], [ -76.339103, 36.829547 ], [ -76.339247, 36.83348 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131034", "TotalPop": 1485.0, "MedHHInc": 53638.0, "TotalUnit": 607.0, "pctWhite": 25.589225589225588, "area": 1124414.9748755444 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.390514, 36.888017 ], [ -76.390143, 36.888781 ], [ -76.380702, 36.890216 ], [ -76.378454, 36.887153 ], [ -76.374507, 36.884949 ], [ -76.374979, 36.881073 ], [ -76.377181, 36.879563 ], [ -76.377846, 36.878628 ], [ -76.380858, 36.878868 ], [ -76.382112, 36.879447 ], [ -76.382882, 36.882994 ], [ -76.389312, 36.882903 ], [ -76.389331, 36.884931 ], [ -76.390519, 36.884947 ], [ -76.390514, 36.888017 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402116002", "TotalPop": 582.0, "MedHHInc": 67000.0, "TotalUnit": 251.0, "pctWhite": 92.783505154639172, "area": 514701.19595742674 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.356002, 36.828772 ], [ -76.347963, 36.829146 ], [ -76.347389, 36.828967 ], [ -76.34728, 36.825984 ], [ -76.347154, 36.82272 ], [ -76.352372, 36.822792 ], [ -76.354133, 36.822864 ], [ -76.355795, 36.824205 ], [ -76.356002, 36.828772 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402117003", "TotalPop": 524.0, "MedHHInc": 26510.0, "TotalUnit": 407.0, "pctWhite": 0.19083969465648853, "area": 702617.9374040236 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.352379, 36.81582 ], [ -76.344857, 36.819564 ], [ -76.337674, 36.823104 ], [ -76.329522, 36.82069 ], [ -76.332266, 36.821042 ], [ -76.336641, 36.820983 ], [ -76.336398, 36.815872 ], [ -76.343544, 36.815495 ], [ -76.34413, 36.815431 ], [ -76.346662, 36.815333 ], [ -76.352379, 36.81582 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131033", "TotalPop": 2428.0, "MedHHInc": 63313.0, "TotalUnit": 1061.0, "pctWhite": 26.606260296540363, "area": 1052417.3584339435 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.400303, 36.873875 ], [ -76.399676, 36.874738 ], [ -76.398202, 36.876798 ], [ -76.396609, 36.877849 ], [ -76.39111, 36.881103 ], [ -76.39068, 36.881675 ], [ -76.390519, 36.884947 ], [ -76.389331, 36.884931 ], [ -76.389312, 36.882903 ], [ -76.382882, 36.882994 ], [ -76.382112, 36.879447 ], [ -76.386993, 36.876419 ], [ -76.389672, 36.873242 ], [ -76.39109, 36.873587 ], [ -76.393835, 36.872412 ], [ -76.39498, 36.872812 ], [ -76.400152, 36.873843 ], [ -76.400303, 36.873875 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131041", "TotalPop": 2794.0, "MedHHInc": 69943.0, "TotalUnit": 916.0, "pctWhite": 20.114531138153186, "area": 1282059.2007268469 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.407099, 36.877954 ], [ -76.405321, 36.881113 ], [ -76.404918, 36.884479 ], [ -76.40414, 36.885039 ], [ -76.405758, 36.885835 ], [ -76.405632, 36.887796 ], [ -76.407476, 36.890544 ], [ -76.406617, 36.891421 ], [ -76.404556, 36.891491 ], [ -76.399937, 36.889383 ], [ -76.397998, 36.883912 ], [ -76.397922, 36.880877 ], [ -76.396589, 36.879215 ], [ -76.396609, 36.877849 ], [ -76.398202, 36.876798 ], [ -76.399676, 36.874738 ], [ -76.400303, 36.873875 ], [ -76.411067, 36.876148 ], [ -76.407099, 36.877954 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402132001", "TotalPop": 1498.0, "MedHHInc": 59722.0, "TotalUnit": 701.0, "pctWhite": 42.189586114819761, "area": 1531649.138543929 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.317208, 36.842704 ], [ -76.315498, 36.847498 ], [ -76.312685, 36.850762 ], [ -76.306663, 36.854047 ], [ -76.301263, 36.850647 ], [ -76.29796, 36.846412 ], [ -76.302998, 36.844597 ], [ -76.302532, 36.843578 ], [ -76.305714, 36.842314 ], [ -76.305697, 36.841396 ], [ -76.30585, 36.841029 ], [ -76.306004, 36.8411 ], [ -76.307231, 36.841357 ], [ -76.30842, 36.841393 ], [ -76.316681, 36.841119 ], [ -76.318075, 36.841932 ], [ -76.317208, 36.842704 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402118004", "TotalPop": 872.0, "MedHHInc": 12704.0, "TotalUnit": 465.0, "pctWhite": 0.22935779816513763, "area": 267456.9255309857 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.329539, 36.824082 ], [ -76.326183, 36.825211 ], [ -76.324196, 36.824607 ], [ -76.324043, 36.821135 ], [ -76.324928, 36.821114 ], [ -76.324092, 36.819636 ], [ -76.326358, 36.81798 ], [ -76.328757, 36.821013 ], [ -76.329539, 36.824082 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402116003", "TotalPop": 750.0, "MedHHInc": 41169.0, "TotalUnit": 323.0, "pctWhite": 75.466666666666669, "area": 516658.13035084866 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.359423, 36.812678 ], [ -76.359083, 36.812881 ], [ -76.355866, 36.815329 ], [ -76.354073, 36.817894 ], [ -76.355299, 36.818457 ], [ -76.352372, 36.822792 ], [ -76.347154, 36.82272 ], [ -76.346783, 36.821684 ], [ -76.344857, 36.819564 ], [ -76.352379, 36.81582 ], [ -76.35526, 36.814372 ], [ -76.35936, 36.812327 ], [ -76.359423, 36.812678 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402118001", "TotalPop": 665.0, "MedHHInc": 41169.0, "TotalUnit": 276.0, "pctWhite": 5.1127819548872182, "area": 384429.23036778171 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.329769, 36.827031 ], [ -76.32138, 36.830914 ], [ -76.319691, 36.831374 ], [ -76.317496, 36.831184 ], [ -76.315481, 36.830654 ], [ -76.312672, 36.830043 ], [ -76.312635, 36.829462 ], [ -76.316149, 36.829265 ], [ -76.324963, 36.827033 ], [ -76.329539, 36.824082 ], [ -76.329769, 36.827031 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402119002", "TotalPop": 732.0, "MedHHInc": 53214.0, "TotalUnit": 335.0, "pctWhite": 15.983606557377051, "area": 516207.73945091886 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.325215, 36.817145 ], [ -76.314514, 36.819312 ], [ -76.312086, 36.81931 ], [ -76.311899, 36.81439 ], [ -76.314444, 36.812539 ], [ -76.322822, 36.815922 ], [ -76.324209, 36.816544 ], [ -76.325215, 36.817145 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402123002", "TotalPop": 1006.0, "MedHHInc": 44420.0, "TotalUnit": 421.0, "pctWhite": 54.473161033797211, "area": 329013.31894312485 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.321025, 36.796194 ], [ -76.318739, 36.796886 ], [ -76.316324, 36.799109 ], [ -76.314358, 36.802287 ], [ -76.313706, 36.802904 ], [ -76.310758, 36.797173 ], [ -76.310925, 36.796521 ], [ -76.320044, 36.79514 ], [ -76.321025, 36.796194 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402130012", "TotalPop": 2950.0, "MedHHInc": 75813.0, "TotalUnit": 1185.0, "pctWhite": 71.152542372881356, "area": 3524797.1677372735 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.378648, 36.856156 ], [ -76.376687, 36.860715 ], [ -76.377358, 36.865995 ], [ -76.372568, 36.867423 ], [ -76.368322, 36.866439 ], [ -76.368078, 36.865314 ], [ -76.365553, 36.861645 ], [ -76.363785, 36.858388 ], [ -76.361581, 36.857495 ], [ -76.358862, 36.855689 ], [ -76.356634, 36.855122 ], [ -76.355138, 36.854031 ], [ -76.35213, 36.853115 ], [ -76.356265, 36.849148 ], [ -76.361389, 36.844078 ], [ -76.362317, 36.84284 ], [ -76.370141, 36.8459 ], [ -76.374484, 36.848513 ], [ -76.37914, 36.851833 ], [ -76.378648, 36.856156 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402124002", "TotalPop": 941.0, "MedHHInc": 55667.0, "TotalUnit": 485.0, "pctWhite": 36.981934112646123, "area": 880479.97947794525 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.334793, 36.797535 ], [ -76.328908, 36.804017 ], [ -76.329082, 36.806516 ], [ -76.319869, 36.806598 ], [ -76.321184, 36.804995 ], [ -76.321538, 36.804457 ], [ -76.323156, 36.801812 ], [ -76.327277, 36.795067 ], [ -76.333821, 36.796133 ], [ -76.335164, 36.796139 ], [ -76.334793, 36.797535 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402125001", "TotalPop": 2116.0, "MedHHInc": 46087.0, "TotalUnit": 899.0, "pctWhite": 54.253308128544418, "area": 2151874.6634464199 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.351904, 36.800748 ], [ -76.348689, 36.802407 ], [ -76.34446, 36.805411 ], [ -76.342635, 36.805872 ], [ -76.335477, 36.806277 ], [ -76.329086, 36.806586 ], [ -76.329082, 36.806516 ], [ -76.328908, 36.804017 ], [ -76.334793, 36.797535 ], [ -76.335164, 36.796139 ], [ -76.335266, 36.794763 ], [ -76.336043, 36.791923 ], [ -76.342065, 36.791032 ], [ -76.344996, 36.793695 ], [ -76.349122, 36.796367 ], [ -76.349874, 36.797102 ], [ -76.349962, 36.798408 ], [ -76.351904, 36.800748 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402128022", "TotalPop": 1041.0, "MedHHInc": 70875.0, "TotalUnit": 598.0, "pctWhite": 72.526416906820373, "area": 2373785.8499491792 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.403666, 36.814048 ], [ -76.397927, 36.823719 ], [ -76.396055, 36.822543 ], [ -76.396337, 36.821034 ], [ -76.39769, 36.82022 ], [ -76.39736, 36.81948 ], [ -76.393708, 36.820277 ], [ -76.393181, 36.819253 ], [ -76.390528, 36.816468 ], [ -76.386429, 36.81318 ], [ -76.386659, 36.811151 ], [ -76.386264, 36.808274 ], [ -76.384489, 36.804413 ], [ -76.381243, 36.80142 ], [ -76.386998, 36.798547 ], [ -76.387199, 36.800627 ], [ -76.388702, 36.802073 ], [ -76.391052, 36.803107 ], [ -76.391732, 36.805122 ], [ -76.394962, 36.8065 ], [ -76.396293, 36.805563 ], [ -76.397596, 36.806702 ], [ -76.399799, 36.806252 ], [ -76.400324, 36.805239 ], [ -76.400265, 36.806437 ], [ -76.403666, 36.814048 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402129001", "TotalPop": 903.0, "MedHHInc": 103050.0, "TotalUnit": 351.0, "pctWhite": 90.143964562569209, "area": 1847505.7897053838 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.383466, 36.837548 ], [ -76.376566, 36.838448 ], [ -76.374494, 36.838415 ], [ -76.366065, 36.838248 ], [ -76.365735, 36.833017 ], [ -76.364752, 36.828987 ], [ -76.367165, 36.82732 ], [ -76.370386, 36.826169 ], [ -76.373084, 36.826054 ], [ -76.377016, 36.827498 ], [ -76.376865, 36.827992 ], [ -76.381468, 36.830418 ], [ -76.383489, 36.832479 ], [ -76.382617, 36.832943 ], [ -76.385233, 36.836416 ], [ -76.383466, 36.837548 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402129002", "TotalPop": 1092.0, "MedHHInc": 35865.0, "TotalUnit": 517.0, "pctWhite": 65.109890109890117, "area": 991547.72167839354 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.368254, 36.824887 ], [ -76.368736, 36.825157 ], [ -76.370386, 36.826169 ], [ -76.367165, 36.82732 ], [ -76.364752, 36.828987 ], [ -76.364216, 36.828042 ], [ -76.360874, 36.825598 ], [ -76.356986, 36.82182 ], [ -76.360773, 36.821599 ], [ -76.360117, 36.819621 ], [ -76.361341, 36.81874 ], [ -76.363127, 36.818773 ], [ -76.363365, 36.817435 ], [ -76.361965, 36.816091 ], [ -76.372273, 36.818177 ], [ -76.368254, 36.824887 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402131031", "TotalPop": 539.0, "MedHHInc": 87875.0, "TotalUnit": 287.0, "pctWhite": 72.35621521335807, "area": 831596.42270630749 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.393267, 36.872066 ], [ -76.388734, 36.87263 ], [ -76.377997, 36.872553 ], [ -76.377938, 36.870461 ], [ -76.37785, 36.869848 ], [ -76.393012, 36.863546 ], [ -76.392815, 36.864472 ], [ -76.392063, 36.870329 ], [ -76.393267, 36.872066 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402130022", "TotalPop": 1273.0, "MedHHInc": 66983.0, "TotalUnit": 648.0, "pctWhite": 77.53338570306363, "area": 1449008.5714116169 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.393859, 36.85797 ], [ -76.393259, 36.862149 ], [ -76.391784, 36.860546 ], [ -76.389907, 36.8597 ], [ -76.389987, 36.859621 ], [ -76.389725, 36.859446 ], [ -76.389105, 36.859066 ], [ -76.37914, 36.851833 ], [ -76.37975, 36.848026 ], [ -76.380545, 36.846353 ], [ -76.381322, 36.840379 ], [ -76.383466, 36.837548 ], [ -76.388266, 36.844948 ], [ -76.388266, 36.848948 ], [ -76.387049, 36.851248 ], [ -76.387421, 36.852199 ], [ -76.38834, 36.853107 ], [ -76.391266, 36.854348 ], [ -76.391866, 36.856548 ], [ -76.394267, 36.856848 ], [ -76.393859, 36.85797 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402103002", "TotalPop": 563.0, "MedHHInc": 39097.0, "TotalUnit": 305.0, "pctWhite": 67.140319715808175, "area": 523277.61726055678 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.349222, 36.8411 ], [ -76.347381, 36.842311 ], [ -76.344697, 36.84247 ], [ -76.338731, 36.842773 ], [ -76.338593, 36.840989 ], [ -76.346805, 36.835327 ], [ -76.347205, 36.835576 ], [ -76.349941, 36.837226 ], [ -76.34883, 36.838328 ], [ -76.351235, 36.840073 ], [ -76.349222, 36.8411 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402104001", "TotalPop": 1322.0, "MedHHInc": 59196.0, "TotalUnit": 718.0, "pctWhite": 68.305597579425111, "area": 1572733.6674265254 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.362317, 36.84284 ], [ -76.361389, 36.844078 ], [ -76.356265, 36.849148 ], [ -76.350465, 36.845648 ], [ -76.350265, 36.844748 ], [ -76.349222, 36.8411 ], [ -76.351235, 36.840073 ], [ -76.34883, 36.838328 ], [ -76.349941, 36.837226 ], [ -76.347205, 36.835576 ], [ -76.347536, 36.834242 ], [ -76.35041, 36.83339 ], [ -76.35541, 36.8337 ], [ -76.355938, 36.834253 ], [ -76.357839, 36.834898 ], [ -76.359255, 36.836332 ], [ -76.364365, 36.838948 ], [ -76.362317, 36.84284 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402109002", "TotalPop": 1559.0, "MedHHInc": 47974.0, "TotalUnit": 1047.0, "pctWhite": 71.199486850545227, "area": 948437.38794998499 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.308327, 36.83772 ], [ -76.30842, 36.841393 ], [ -76.307231, 36.841357 ], [ -76.306004, 36.8411 ], [ -76.30585, 36.841029 ], [ -76.305697, 36.841396 ], [ -76.305714, 36.842314 ], [ -76.302532, 36.843578 ], [ -76.302998, 36.844597 ], [ -76.29796, 36.846412 ], [ -76.295863, 36.843847 ], [ -76.294262, 36.841647 ], [ -76.295045, 36.837046 ], [ -76.308467, 36.836715 ], [ -76.308327, 36.83772 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402111002", "TotalPop": 986.0, "MedHHInc": 23527.0, "TotalUnit": 515.0, "pctWhite": 16.125760649087219, "area": 1256349.0823776801 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.330346, 36.837639 ], [ -76.327126, 36.837796 ], [ -76.325389, 36.837439 ], [ -76.318458, 36.837124 ], [ -76.31542, 36.836555 ], [ -76.308467, 36.836715 ], [ -76.308402, 36.835144 ], [ -76.30833, 36.833605 ], [ -76.316759, 36.833401 ], [ -76.317956, 36.832902 ], [ -76.318245, 36.831801 ], [ -76.317496, 36.831184 ], [ -76.319691, 36.831374 ], [ -76.32138, 36.830914 ], [ -76.329769, 36.827031 ], [ -76.330034, 36.830482 ], [ -76.330414, 36.834647 ], [ -76.330346, 36.837639 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402119001", "TotalPop": 795.0, "MedHHInc": 32212.0, "TotalUnit": 360.0, "pctWhite": 3.2704402515723272, "area": 365547.51086408156 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.326358, 36.81798 ], [ -76.324092, 36.819636 ], [ -76.324928, 36.821114 ], [ -76.324043, 36.821135 ], [ -76.31946, 36.821275 ], [ -76.312263, 36.821488 ], [ -76.312086, 36.81931 ], [ -76.314514, 36.819312 ], [ -76.325215, 36.817145 ], [ -76.326358, 36.81798 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402106001", "TotalPop": 1038.0, "MedHHInc": 75104.0, "TotalUnit": 398.0, "pctWhite": 68.882466281310215, "area": 823011.54232267092 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.330831, 36.845385 ], [ -76.329521, 36.846749 ], [ -76.326845, 36.8462 ], [ -76.319061, 36.847423 ], [ -76.315498, 36.847498 ], [ -76.317208, 36.842704 ], [ -76.318075, 36.841932 ], [ -76.321714, 36.842039 ], [ -76.325648, 36.842948 ], [ -76.327126, 36.837796 ], [ -76.330346, 36.837639 ], [ -76.330831, 36.845385 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402116004", "TotalPop": 735.0, "MedHHInc": 54643.0, "TotalUnit": 334.0, "pctWhite": 93.061224489795919, "area": 866834.83886934642 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.361744, 36.82878 ], [ -76.356002, 36.828772 ], [ -76.355795, 36.824205 ], [ -76.354133, 36.822864 ], [ -76.352372, 36.822792 ], [ -76.355299, 36.818457 ], [ -76.354073, 36.817894 ], [ -76.355866, 36.815329 ], [ -76.359083, 36.812881 ], [ -76.359423, 36.812678 ], [ -76.359454, 36.812834 ], [ -76.359854, 36.815805 ], [ -76.361965, 36.816091 ], [ -76.363365, 36.817435 ], [ -76.363127, 36.818773 ], [ -76.361341, 36.81874 ], [ -76.360117, 36.819621 ], [ -76.360773, 36.821599 ], [ -76.356986, 36.82182 ], [ -76.360874, 36.825598 ], [ -76.364216, 36.828042 ], [ -76.361744, 36.82878 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517409801001", "TotalPop": 689.0, "MedHHInc": 54643.0, "TotalUnit": 0.0, "pctWhite": 56.023222060957913, "area": 3749949.4003515756 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.311899, 36.81439 ], [ -76.306359, 36.817151 ], [ -76.306046, 36.818693 ], [ -76.3033, 36.819093 ], [ -76.299478, 36.820537 ], [ -76.295485, 36.82209 ], [ -76.297971, 36.826596 ], [ -76.293135, 36.829219 ], [ -76.289962, 36.822048 ], [ -76.291262, 36.818448 ], [ -76.290061, 36.808742 ], [ -76.291562, 36.799948 ], [ -76.292144, 36.798663 ], [ -76.295331, 36.799012 ], [ -76.300721, 36.798449 ], [ -76.301452, 36.799106 ], [ -76.303105, 36.800604 ], [ -76.305927, 36.800782 ], [ -76.307064, 36.803339 ], [ -76.304226, 36.806723 ], [ -76.304802, 36.81042 ], [ -76.310088, 36.812032 ], [ -76.311899, 36.81439 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402116001", "TotalPop": 817.0, "MedHHInc": 53707.0, "TotalUnit": 366.0, "pctWhite": 72.827417380660947, "area": 402025.24030362826 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.356158, 36.83381 ], [ -76.355938, 36.834253 ], [ -76.35541, 36.8337 ], [ -76.35041, 36.83339 ], [ -76.347536, 36.834242 ], [ -76.347389, 36.828967 ], [ -76.347963, 36.829146 ], [ -76.356002, 36.828772 ], [ -76.356158, 36.83381 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402132002", "TotalPop": 850.0, "MedHHInc": 44821.0, "TotalUnit": 334.0, "pctWhite": 33.647058823529413, "area": 451911.80433184688 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.318075, 36.841932 ], [ -76.316681, 36.841119 ], [ -76.30842, 36.841393 ], [ -76.308327, 36.83772 ], [ -76.308467, 36.836715 ], [ -76.31542, 36.836555 ], [ -76.318458, 36.837124 ], [ -76.318075, 36.841932 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402116005", "TotalPop": 991.0, "MedHHInc": 43368.0, "TotalUnit": 470.0, "pctWhite": 90.110998990918262, "area": 777143.36741346098 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.366065, 36.838248 ], [ -76.364365, 36.838948 ], [ -76.359255, 36.836332 ], [ -76.357839, 36.834898 ], [ -76.355938, 36.834253 ], [ -76.356158, 36.83381 ], [ -76.356002, 36.828772 ], [ -76.361744, 36.82878 ], [ -76.364216, 36.828042 ], [ -76.364752, 36.828987 ], [ -76.365735, 36.833017 ], [ -76.366065, 36.838248 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402123001", "TotalPop": 1309.0, "MedHHInc": 27188.0, "TotalUnit": 555.0, "pctWhite": 36.898395721925134, "area": 1645685.8298707556 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.321184, 36.804995 ], [ -76.319869, 36.806598 ], [ -76.316478, 36.810671 ], [ -76.314444, 36.812539 ], [ -76.311899, 36.81439 ], [ -76.310088, 36.812032 ], [ -76.304802, 36.81042 ], [ -76.304226, 36.806723 ], [ -76.307064, 36.803339 ], [ -76.305927, 36.800782 ], [ -76.303105, 36.800604 ], [ -76.301452, 36.799106 ], [ -76.302971, 36.797849 ], [ -76.310925, 36.796521 ], [ -76.310758, 36.797173 ], [ -76.313706, 36.802904 ], [ -76.318281, 36.804688 ], [ -76.321538, 36.804457 ], [ -76.321184, 36.804995 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402130023", "TotalPop": 2186.0, "MedHHInc": 59697.0, "TotalUnit": 916.0, "pctWhite": 58.188472095150956, "area": 1564013.8045203888 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.393012, 36.863546 ], [ -76.37785, 36.869848 ], [ -76.377358, 36.865995 ], [ -76.376687, 36.860715 ], [ -76.378648, 36.856156 ], [ -76.37914, 36.851833 ], [ -76.389105, 36.859066 ], [ -76.389725, 36.859446 ], [ -76.389987, 36.859621 ], [ -76.389907, 36.8597 ], [ -76.391784, 36.860546 ], [ -76.393259, 36.862149 ], [ -76.393012, 36.863546 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402115002", "TotalPop": 1339.0, "MedHHInc": 23703.0, "TotalUnit": 545.0, "pctWhite": 30.097087378640776, "area": 429155.09735020547 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.34728, 36.825984 ], [ -76.339005, 36.826168 ], [ -76.338868, 36.82444 ], [ -76.337674, 36.823104 ], [ -76.344857, 36.819564 ], [ -76.346783, 36.821684 ], [ -76.347154, 36.82272 ], [ -76.34728, 36.825984 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402129004", "TotalPop": 1759.0, "MedHHInc": 56900.0, "TotalUnit": 858.0, "pctWhite": 77.430358158044342, "area": 1967369.9454393764 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.397902, 36.823763 ], [ -76.395466, 36.828148 ], [ -76.388796, 36.833516 ], [ -76.388466, 36.834348 ], [ -76.385233, 36.836416 ], [ -76.382617, 36.832943 ], [ -76.383489, 36.832479 ], [ -76.381468, 36.830418 ], [ -76.376865, 36.827992 ], [ -76.377016, 36.827498 ], [ -76.380509, 36.819625 ], [ -76.395123, 36.822226 ], [ -76.396055, 36.822543 ], [ -76.397927, 36.823719 ], [ -76.397902, 36.823763 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402123003", "TotalPop": 1202.0, "MedHHInc": 52708.0, "TotalUnit": 595.0, "pctWhite": 51.081530782029951, "area": 490006.25060132548 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.327277, 36.795067 ], [ -76.323156, 36.801812 ], [ -76.316324, 36.799109 ], [ -76.318739, 36.796886 ], [ -76.321025, 36.796194 ], [ -76.320044, 36.79514 ], [ -76.322639, 36.794177 ], [ -76.328806, 36.792999 ], [ -76.327277, 36.795067 ] ] ] ] } },
  { "type": "Feature", "properties": { "GEOID": "517402128013", "TotalPop": 1854.0, "MedHHInc": 43836.0, "TotalUnit": 875.0, "pctWhite": 40.776699029126213, "area": 1081561.1557987577 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -76.381705, 36.805222 ], [ -76.378388, 36.806215 ], [ -76.380824, 36.807987 ], [ -76.379649, 36.809631 ], [ -76.375236, 36.810005 ], [ -76.374192, 36.814956 ], [ -76.370222, 36.814522 ], [ -76.361997, 36.811667 ], [ -76.359454, 36.812834 ], [ -76.359423, 36.812678 ], [ -76.35936, 36.812327 ], [ -76.378543, 36.80277 ], [ -76.379855, 36.803931 ], [ -76.381705, 36.805222 ] ] ] ] } }
  ]
  };

import {port_pred} from './data/rstudio-export/port_pred_crop.js' ;
  
// Dropdown selections
const select = document.getElementById('property-select');
const select2 = document.getElementById('geo-select');
const select3 = document.getElementById('landcover-select');
const select4 = document.getElementById('landcoverrisk-select');

// Find the maximum value in the GeoJSON data
const findMaxValue = (features, property) => {
  let max = 0;
  features.forEach((feature) => {
    const value = feature.properties[property];
    if (value > max) {
      max = value;
    }
  });
  return max;
};

// Define a color scale based on population values
const getColor = (value, maxValue) => {
  return value > 0.9 * maxValue ? '#263f33' :
    value > 0.8 * maxValue ? '#517a70' :
    value > 0.6 * maxValue ? '#749f96' :
    value > 0.4 * maxValue ? '#9cc0b2' :
    value > 0.2 * maxValue ? '#b0d0c5' :
    '#cfe8df';
};

let selectedProperty = '';
let maxValue = 0;

const style = (feature) => {
  return {
    fillColor: getColor(feature.properties[selectedProperty], maxValue),
    fillOpacity: 0.7,
    weight: 2,
    opacity: 1,
    color: 'white',
    dashArray: '3',
  };
};

const highlightFeature = (e) => {
  const layer = e.target;
  layer.setStyle({
    weight: 5,
    color: '#666',
    dashArray: '',
    fillOpacity: 0.4
  });

  if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
    layer.bringToFront();
  }

  // Create a popup with the feature properties
  const popupContent = "GEOID:" + layer.feature.properties.GEOID + "<br>" + selectedProperty + ":" + layer.feature.properties[selectedProperty];
  layer.bindPopup(popupContent).openPopup();
};

const resetHighlight = (e) => {
  popLayer.resetStyle(e.target);
  e.target.closePopup();
  popLayer.bringToBack();
};

const onEachFeature = (feature, layer) => {
  layer.on({
    mouseover: highlightFeature,
    mouseout: resetHighlight
  });
};

let popLayer = L.geoJSON(portdata, { style: style, onEachFeature: onEachFeature });

const updateMap = () => {
    censuslegend.remove();
    map.removeLayer(popLayer);
    if (selectedProperty != 'Emptyselection'){
    popLayer = L.geoJSON(portdata, { style: style, onEachFeature: onEachFeature }).addTo(map);
    censuslegend.addTo(map);
  }
};

// Add an event listener for the 'change' event
select.addEventListener('change', (event) => {
  // Get the selected option value
  selectedProperty = event.target.value;

  // Do something with the selected option value
  console.log('Selected option:', selectedProperty);

  maxValue = findMaxValue(portdata.features, selectedProperty);

  // Update the map with the new GeoJSON layer and style
  updateMap();
});

/*
const lcStyle = () => {
  return {
    fillColor: '#ccadb2',
    fillOpacity: 0.7,
    weight: 2,
    opacity: 1,
    color: '#ccadb2'

  };
};
*/
/*
select2.addEventListener('change', (event) => {
  // Get the selected option value
  const selectedLandcover = event.target.value;

  // Do something with the selected option value
  console.log('Selected landcover:', selectedLandcover);

  if (selectedLandcover === 'lc_2018') {
    // Add port_pred data to the map
    // Make sure to replace `port_pred` with your actual data
    // and add the appropriate style and onEachFeature functions as needed

    const portPredLayer = L.geoJSON(port_pred, { style: lcStyle  }).addTo(map);
    portPredLayer.bringToFront();
  } else if (selectedLandcover === 'lc_predict') {
    // Remove port_pred data from the map and add the 2022 Landcover Change with red fill color
    // Make sure to replace `port_pred` and `lc_predict_data` with your actual data
    map.removeLayer(port_pred);
    const lcPredictLayer = L.geoJSON(port_pred, { style: lcStyle }).addTo(map);
    lcPredictLayer.bringToFront();
  }
});
*/
// predict geojson
const port_pred_updated = {
  ...port_pred,
  features: port_pred.features.map((feature) => {
    const {originallc, ...properties} = feature.properties;
    let updatedOriginallc;
    if (originallc === 1) {
      updatedOriginallc = 'Water';
    } else if (originallc === 2) {
      updatedOriginallc = 'Emergent Wetlands';
    } else if (originallc === 3) {
      updatedOriginallc = 'Tree Canopy';
    } else if (originallc === 4) {
      updatedOriginallc = 'Scrub\Shrub';
    } else if (originallc === 5) {
      updatedOriginallc = 'Low Vegetation';
    } else {
      updatedOriginallc = originallc;
    }
    return {
      ...feature,
      properties: {
        ...properties,
        originallc: updatedOriginallc
      }
    };
  })
};

let lcPredictLayer;
// Create a function to show the predLayer on the map

const getPredColor = (percentPrediction) => {
  if (percentPrediction < 5) {
    return '#b0d0c5';
  } else if (percentPrediction < 10) {
    return '#9cc0b2';
  } else if (percentPrediction < 15) {
    return '#749f96';
  } else if (percentPrediction < 20) {
    return '#517a70';
  } else if (percentPrediction < 30) {
    return '#263f33';
  } else {
    return 'red';
  }
};

const showPredLayer = () => {
  if (map.hasLayer(lcPredictLayer)) {
    map.removeLayer(lcPredictLayer);
    predlegend.remove();
  } else{

    lcPredictLayer = L.geoJSON(port_pred_updated, { style: (feature) => {
        const percentPrediction = feature.properties.probability * 100;
        return {
          fillColor: getPredColor(percentPrediction),
          weight: 1,
          opacity: 1,
          color: getPredColor(percentPrediction),
          dashArray: '3',
          fillOpacity: 1
        };
      }, onEachFeature: onEachPredFeature }).addTo(map);
    predlegend.addTo(map);
    lcPredictLayer.bringToFront();
  }
};

let currentLayer;

const onEachPredFeature = (feature, layer) => {
  layer.on('click', (e) => {
    const cellInfo = e.target.feature.properties;
    const percentPrediction = (cellInfo.probability*100).toFixed(2);
    const popupContent = `
    <div class="popup-content">
      <h3 class="popup-title">Cell Information</h3>
      <p><strong>Original Landcover:</strong> ${cellInfo.originallc}</p>
      <p><strong>Probability to change:</strong> ${percentPrediction}%</p>
    </div>
    `;
    layer.bindPopup(popupContent).openPopup();
    
    // Remove the style from the previously clicked layer, if any
    if (currentLayer) {
      currentLayer.setStyle({fillColor:  getPredColor(percentPrediction), color: getPredColor(percentPrediction), weight: 1});
    }

    // Change the layer style when clicked
    layer.setStyle({fillColor: '#ebf463', color: 'yellow', weight: 5});

    // Set the current layer to the clicked layer
    currentLayer = layer;
  });
};

select3.addEventListener('click', showPredLayer);



// predict raster
let lcRiskLayer;
// Create a function to show the predLayer on the map
const showRiskLayer = () => {
  if (map.hasLayer(lcRiskLayer)) {
    map.removeLayer(lcRiskLayer);
    risklegend.remove();
  } else{
    lcRiskLayer = L.tileLayer('https://storage.googleapis.com/raster_layers_tile/port_color-geoinfo/{z}/{x}/{y}.png', {tms: 1, opacity: 0.8, attribution: "", minZoom: 10, maxZoom: 16}).addTo(map);
    lcRiskLayer.bringToFront();
    risklegend.addTo(map);
  }
};
select4.addEventListener('click', showRiskLayer);


// original raster
let lc2018Layer;
let lc2014Layer;
// Create a function to show the predLayer on the map
select2.addEventListener('change', (event) => {
  const value = event.target.value;

  // Check which option was selected and show the corresponding layer
  if (value === '2018_lc') {
    // Show the 2018 landcover layer
    if (map.hasLayer(lc2014Layer)) {
      map.removeLayer(lc2014Layer);
    }
    lc2018Layer = L.tileLayer('https://storage.googleapis.com/raster_layers_tile/port-with-geoinfo/port-with-geoinfo/{z}/{x}/{y}.png', {tms: 1, opacity: 0.7, attribution: "", minZoom: 10, maxZoom: 16}).addTo(map);
  } else if (value === '2014_lc') {
    // Show the 2014 landcover layer
    if (map.hasLayer(lc2018Layer)) {
      map.removeLayer(lc2018Layer);
    }
    lc2014Layer = L.tileLayer('https://storage.googleapis.com/raster_layers_tile/port_14-with-geoinfo/{z}/{x}/{y}.png', {tms: 1, opacity: 0.7, attribution: "", minZoom: 10, maxZoom: 16}).addTo(map);
  } else {
    // The user selected the empty option
    if (map.hasLayer(lc2018Layer)) {
      map.removeLayer(lc2018Layer);
    }
    if (map.hasLayer(lc2014Layer)) {
      map.removeLayer(lc2014Layer);
    }
  }
});





// Create a custom control for the legend
const risklegend = L.control({position: 'topright'});

risklegend.onAdd = function(map) {
  const div = L.DomUtil.create('div', 'legend');
  div.innerHTML = `
    <div><span style="background-color: #445a67; width: 20px; height: 10px; display: inline-block;"></span> Highly Unlikely</div>
    <div><span style="background-color: #57838d; width: 20px; height: 10px; display: inline-block;"></span> Not Probable</div>
    <div><span style="background-color: #b4c9c7; width: 20px; height: 10px; display: inline-block;"></span> Probable</div>
    <div><span style="background-color: #f3bfb3; width: 20px; height: 10px; display: inline-block;"></span> Not Certain</div>
    <div><span style="background-color: #ccadb2; width: 20px; height: 10px; display: inline-block;"></span> Close to Change</div>
  `;
  return div;
};

const censuslegend = L.control({position: 'topright'});

censuslegend.onAdd = function(map) {
  const div = L.DomUtil.create('div', 'legend');
  div.innerHTML = `
    <div><span style="background-color: #b0d0c5; width: 20px; height: 10px; display: inline-block;"></span> Low Risk</div>
    <div><span style="background-color: #9cc0b2; width: 20px; height: 10px; display: inline-block;"></span> Low-Moderate Risk</div>
    <div><span style="background-color: #749f96; width: 20px; height: 10px; display: inline-block;"></span> Moderate Risk</div>
    <div><span style="background-color: #517a70; width: 20px; height: 10px; display: inline-block;"></span> Moderate-High Risk</div>
    <div><span style="background-color: #263f33; width: 20px; height: 10px; display: inline-block;"></span> High Risk</div>
  `;
  return div;
};

const predlegend = L.control({position: 'topright'});

predlegend.onAdd = function(map) {
  const div = L.DomUtil.create('div', 'legend');
  div.innerHTML = `
    <h3 class="popup-title"; style= "font-family: 'Quicksand', sans-serif;">Click a cell <br>for more info!</h3>
    <div><span style="background-color: #b0d0c5; width: 20px; height: 10px; display: inline-block;"></span> Low Risk</div>
    <div><span style="background-color: #9cc0b2; width: 20px; height: 10px; display: inline-block;"></span> Low-Moderate Risk</div>
    <div><span style="background-color: #749f96; width: 20px; height: 10px; display: inline-block;"></span> Moderate Risk</div>
    <div><span style="background-color: #517a70; width: 20px; height: 10px; display: inline-block;"></span> Moderate-High Risk</div>
    <div><span style="background-color: #263f33; width: 20px; height: 10px; display: inline-block;"></span> High Risk</div>
    <div><span style="background-color: red; width: 20px; height: 10px; display: inline-block;"></span> Need Attention</div>
  `;
  return div;
};




/*
// Load GeoTIFF file using geotiff.js
fetch('/county_page/data/USGS_1_n37w077_20210610.tif')
  .then((response) => response.arrayBuffer())
  .then((arrayBuffer) => {
    // Parse the GeoTIFF file
    return GeoTIFF.fromArrayBuffer(arrayBuffer);
  })
  .then((tiff) => tiff.getImage())
  .then((image) => {
    // Get the bounding box for the GeoTIFF image
    const bbox = image.getBoundingBox();

    // Create a raster layer using leaflet-geotiff
    const geoLayer = L.leafletGeotiff(image.readRasters(), {
      image: image,
      bounds: L.latLngBounds(
        L.latLng(bbox[1], bbox[0]),
        L.latLng(bbox[3], bbox[2])
      ),
      // You can customize the rendering options here
      renderer: L.LeafletGeotiff.rgb(),
    }).addTo(map);
  });
*/



  



